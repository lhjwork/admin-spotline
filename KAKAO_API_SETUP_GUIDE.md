# 카카오 API 키 설정 가이드

## 🔑 카카오 API 키 발급 및 설정

### 1. 카카오 개발자 센터 접속
1. [카카오 개발자 센터](https://developers.kakao.com/) 접속
2. 카카오 계정으로 로그인

### 2. 애플리케이션 생성
1. **내 애플리케이션** 메뉴 클릭
2. **애플리케이션 추가하기** 클릭
3. 앱 정보 입력:
   - **앱 이름**: SpotLine Admin (또는 원하는 이름)
   - **사업자명**: 개인 또는 회사명
4. **저장** 클릭

### 3. API 키 확인
애플리케이션 생성 후 **앱 키** 탭에서 다음 키들을 확인:

- **JavaScript 키**: `xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx`
- **REST API 키**: `xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx`

### 4. 플랫폼 설정
1. **플랫폼** 탭 클릭
2. **Web 플랫폼 등록** 클릭
3. **사이트 도메인** 입력:
   ```
   http://localhost:3004
   ```
4. **저장** 클릭

### 5. 환경변수 설정
`.env.local` 파일에 발급받은 API 키를 설정:

```bash
VITE_API_URL=https://lhjwork-backend-spotline.onrender.com
VITE_KAKAO_REST_API_KEY=여기에_REST_API_키_입력
VITE_KAKAO_JAVASCRIPT_KEY=여기에_JavaScript_키_입력
VITE_TIMEZONE=Asia/Seoul
```

**예시:**
```bash
VITE_API_URL=https://lhjwork-backend-spotline.onrender.com
VITE_KAKAO_REST_API_KEY=f4c5c8b8c8b8c8b8c8b8c8b8c8b8c8b8
VITE_KAKAO_JAVASCRIPT_KEY=a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6
VITE_TIMEZONE=Asia/Seoul
```

### 6. 개발 서버 재시작
환경변수 변경 후 개발 서버를 재시작:

```bash
# 터미널에서 Ctrl+C로 서버 중지 후
npm run dev
```

## 🧪 테스트 방법

### 1. 기본 테스트
1. `http://localhost:3004/operational-stores/new` 접속
2. "주소 검색" 버튼 클릭
3. 주소 선택 후 좌표가 자동으로 입력되는지 확인

### 2. 지도 확인
1. 주소 선택 후 "지도 보기" 버튼 클릭
2. 선택한 주소의 위치가 지도에 정확히 표시되는지 확인
3. 마커와 정보창이 올바르게 표시되는지 확인

### 3. 콘솔 로그 확인
브라우저 개발자 도구(F12) > Console 탭에서 다음 로그들을 확인:

```
=== 다음 우편번호 API 원본 데이터 ===
=== 카카오 지오코딩 API 호출 ===
=== 카카오 지오코딩 API 응답 ===
=== 최종 결과 (부모 컴포넌트 전달) ===
```

## 🔧 기능 설명

### 1. **다중 지오코딩 지원**
- **1차**: 카카오 REST API 사용
- **2차**: 카카오 JavaScript SDK 사용 (백업)
- 두 방법 모두 실패 시 좌표 없이 주소만 저장

### 2. **실시간 지도 확인**
- 주소 선택 후 "지도 보기" 버튼으로 위치 확인
- 마커와 정보창으로 정확한 위치 표시
- 좌표 정보와 출처 표시

### 3. **상세 로깅**
- 다음 우편번호 API 응답 데이터 전체 로깅
- 카카오 지오코딩 과정 상세 로깅
- 에러 발생 시 상세한 디버깅 정보 제공

### 4. **사용자 피드백**
- 좌표 변환 성공/실패 상태 표시
- API 키 미설정 시 안내 메시지
- 로딩 상태 및 에러 메시지 표시

## 🚨 문제 해결

### 1. "API 키 상태: 미설정" 메시지가 나올 때
- `.env.local` 파일의 API 키가 올바르게 설정되었는지 확인
- 개발 서버를 재시작했는지 확인

### 2. "좌표 변환 실패" 메시지가 나올 때
- 카카오 개발자 센터에서 플랫폼 도메인이 올바르게 설정되었는지 확인
- 브라우저 콘솔에서 CORS 에러가 있는지 확인

### 3. 지도가 표시되지 않을 때
- JavaScript 키가 올바르게 설정되었는지 확인
- 브라우저 콘솔에서 카카오 지도 SDK 로드 에러가 있는지 확인

### 4. 주소 검색 팝업이 열리지 않을 때
- 브라우저에서 팝업이 차단되었는지 확인
- 다음 우편번호 서비스 스크립트가 로드되었는지 확인

## 📋 체크리스트

- [ ] 카카오 개발자 센터에서 앱 생성
- [ ] JavaScript 키와 REST API 키 발급
- [ ] 플랫폼에 `http://localhost:3004` 도메인 등록
- [ ] `.env.local`에 API 키 설정
- [ ] 개발 서버 재시작
- [ ] 주소 검색 기능 테스트
- [ ] 좌표 자동 입력 확인
- [ ] 지도 표시 기능 확인
- [ ] 콘솔 로그 확인

## 🎯 완료 후 기능

✅ **다음 우편번호 서비스**: 한국 주소 검색  
✅ **자동 좌표 변환**: 카카오 API로 위도/경도 추출  
✅ **실시간 지도 확인**: 선택한 위치를 지도에서 확인  
✅ **상세 로깅**: 모든 API 응답 데이터 콘솔 출력  
✅ **에러 처리**: API 키 미설정, 좌표 변환 실패 등 처리  
✅ **사용자 피드백**: 로딩, 성공, 실패 상태 표시  

이제 카카오 API 키만 설정하면 완전한 주소 검색 및 지도 확인 기능을 사용할 수 있습니다!